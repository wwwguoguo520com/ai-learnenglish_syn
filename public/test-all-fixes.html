<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´ä¿®å¤æµ‹è¯• - v4.2</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 30px;
            margin: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .test-summary h1 {
            margin: 0 0 20px 0;
            font-size: 28px;
        }
        .fix-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .fix-item {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .fix-item h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .fix-item p {
            margin: 0;
            font-size: 14px;
            opacity: 0.9;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        [data-theme="dark"] .test-section {
            background: #1e293b;
        }
        .test-section h2 {
            margin-top: 0;
            color: #667eea;
        }
        [data-theme="dark"] .test-section h2 {
            color: #a78bfa;
        }
        .test-steps {
            background: #f8fafc;
            border-left: 4px solid #667eea;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        [data-theme="dark"] .test-steps {
            background: #0f172a;
            border-left-color: #a78bfa;
        }
        .test-steps ol {
            margin: 10px 0;
            padding-left: 25px;
        }
        .test-steps li {
            margin: 8px 0;
            line-height: 1.6;
        }
        .highlight-demo {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            margin: 0 2px;
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="test-summary">
            <h1>ğŸ‰ è‹±è¯­æ ‡æ³¨å·¥å…· - å®Œæ•´ä¿®å¤æµ‹è¯• v4.2</h1>
            <p style="font-size: 16px; margin: 0 0 20px 0;">æ‰€æœ‰é—®é¢˜å·²ä¿®å¤å¹¶å¢å¼ºï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†æµ‹è¯•æŒ‡å—</p>

            <div class="fix-list">
                <div class="fix-item">
                    <h3>âœ… ä¿®å¤1ï¼šé€‰ä¸­æ–‡æœ¬å¼¹å‡ºæ ‡è®°æ¡†</h3>
                    <p>è§£å†³äº†äº‹ä»¶ç›‘å¬å™¨å†²çªï¼Œé€‰ä¸­æ–‡æœ¬ç°åœ¨èƒ½æ­£å¸¸å¼¹å‡ºæ ‡æ³¨å·¥å…·æ </p>
                </div>
                <div class="fix-item">
                    <h3>âœ… ä¿®å¤2ï¼šå¿«é€Ÿæ ‡æ³¨æ¨¡å¼</h3>
                    <p>ä¿®å¤äº†applyHighlightå‚æ•°é”™è¯¯ï¼Œå¿«é€Ÿæ ‡æ³¨æ¨¡å¼ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œ</p>
                </div>
                <div class="fix-item">
                    <h3>âœ… ä¿®å¤3ï¼šé»‘æš—æ¨¡å¼é¢œè‰²</h3>
                    <p>æ·»åŠ äº†é»‘æš—æ¨¡å¼ä¸‹çš„æ–‡å­—é¢œè‰²é€‚é…ï¼Œè§£å†³äº†çœ‹ä¸è§å­—çš„é—®é¢˜</p>
                </div>
                <div class="fix-item">
                    <h3>ğŸ†• å¢å¼º4ï¼šAIé€å¥åˆ†æ</h3>
                    <p>æ–°å¢AIè¯­æ³•åˆ†æé€å¥æ¨¡å¼ï¼Œæ”¯æŒè¿›åº¦æ˜¾ç¤ºå’Œæ›´å‡†ç¡®çš„å¥å­çº§åˆ«åˆ†æ</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ“ æµ‹è¯•1ï¼šé€‰ä¸­æ–‡æœ¬æ ‡æ³¨</h2>
            <div class="test-steps">
                <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
                <ol>
                    <li>ç‚¹å‡»ä¸‹æ–¹"åŠ è½½æµ‹è¯•æ–‡æœ¬"æŒ‰é’®</li>
                    <li>åœ¨é˜…è¯»åŒºé€‰ä¸­ä»»æ„æ–‡æœ¬</li>
                    <li>åº”è¯¥ä¼šç«‹å³å¼¹å‡ºæ ‡æ³¨å·¥å…·æ </li>
                    <li>é€‰æ‹©ç±»åˆ«ã€é¢œè‰²åä¿å­˜</li>
                    <li>æ–‡æœ¬åº”è¯¥è¢«æ­£ç¡®æ ‡æ³¨</li>
                </ol>
            </div>
            <p><strong>é¢„æœŸç»“æœï¼š</strong>å·¥å…·æ æ­£å¸¸å¼¹å‡ºï¼Œæ ‡æ³¨æˆåŠŸåº”ç”¨</p>
        </div>

        <div class="test-section">
            <h2>âš¡ æµ‹è¯•2ï¼šå¿«é€Ÿæ ‡æ³¨æ¨¡å¼</h2>
            <div class="test-steps">
                <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
                <ol>
                    <li>ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„"å¿«é€Ÿæ ‡æ³¨"æŒ‰é’®ï¼ˆæˆ–æŒ‰ Ctrl+Qï¼‰</li>
                    <li>åœ¨å·¥å…·æ ä¸­é€‰æ‹©é¢œè‰²å’Œæ ·å¼ï¼ˆå¦‚ï¼šåŠ ç²—ã€èœœç³–è‰²ï¼‰</li>
                    <li>é€‰ä¸­é˜…è¯»åŒºçš„æ–‡æœ¬</li>
                    <li>æ ‡æ³¨åº”è¯¥ç«‹å³åº”ç”¨ï¼Œæ— éœ€å¼¹å‡ºå¯¹è¯æ¡†</li>
                    <li>ç‚¹å‡»"é€€å‡ºå¿«é€Ÿæ ‡æ³¨"ç»“æŸæ¨¡å¼</li>
                </ol>
            </div>
            <p><strong>é¢„æœŸç»“æœï¼š</strong>é€‰ä¸­å³æ ‡æ³¨ï¼Œå¿«é€Ÿé«˜æ•ˆï¼Œæœ‰æˆåŠŸæç¤º</p>
        </div>

        <div class="test-section">
            <h2>ğŸŒ™ æµ‹è¯•3ï¼šé»‘æš—æ¨¡å¼é¢œè‰²</h2>
            <div class="test-steps">
                <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
                <ol>
                    <li>ç‚¹å‡»å³ä¸Šè§’çš„ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼ˆğŸŒ™ å›¾æ ‡ï¼‰</li>
                    <li>åˆ‡æ¢åˆ°é»‘æš—æ¨¡å¼</li>
                    <li>åˆ›å»ºä¸åŒç±»åˆ«çš„æ ‡æ³¨ï¼ˆç”Ÿè¯ã€è¯ç»„ã€ç–‘éš¾ç­‰ï¼‰</li>
                    <li>æ£€æŸ¥æ–‡å­—æ˜¯å¦æ¸…æ™°å¯è§</li>
                    <li>åˆ‡æ¢å›äº®è‰²æ¨¡å¼å¯¹æ¯”</li>
                </ol>
            </div>
            <p><strong>é¢„æœŸç»“æœï¼š</strong>é»‘æš—æ¨¡å¼ä¸‹æ‰€æœ‰æ–‡å­—éƒ½æ¸…æ™°å¯è§ï¼Œé¢œè‰²å¯¹æ¯”åº¦è‰¯å¥½</p>
            <p><strong>é¢œè‰²ç¤ºä¾‹ï¼š</strong></p>
            <div style="margin-top: 10px;">
                <span class="highlight-demo" style="background: #9a7b00; color: #fbbf24;">ç”Ÿè¯ (vocab)</span>
                <span class="highlight-demo" style="background: #065f46; color: #6ee7b7;">è¯ç»„ (phrase)</span>
                <span class="highlight-demo" style="background: #6b21a8; color: #c084fc;">ç–‘éš¾ (difficulty)</span>
                <span class="highlight-demo" style="background: #c2410c; color: #f87171;">é‡ç‚¹ (keypoint)</span>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ¤– æµ‹è¯•4ï¼šAIè¯­æ³•åˆ†æï¼ˆå¢å¼ºç‰ˆï¼‰</h2>
            <div class="test-steps">
                <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
                <ol>
                    <li>ç‚¹å‡»å³ä¸Šè§’"ğŸ¤– AI"æŒ‰é’®é…ç½®APIå¯†é’¥</li>
                    <li>è¾“å…¥OpenAIæˆ–å…¼å®¹çš„APIå¯†é’¥å’Œç«¯ç‚¹</li>
                    <li>ä¿å­˜è®¾ç½®</li>
                    <li>ç‚¹å‡»"ğŸ¤– AIåˆ†æ"æŒ‰é’®</li>
                    <li>é€‰æ‹©"é€å¥åˆ†æ"æ¨¡å¼ï¼ˆæ¨èï¼‰æˆ–"æ•´ä½“åˆ†æ"</li>
                    <li>ç­‰å¾…åˆ†æå®Œæˆï¼ŒæŸ¥çœ‹è¿›åº¦æç¤º</li>
                    <li>æ£€æŸ¥è‡ªåŠ¨åº”ç”¨çš„è¯­æ³•æ ‡æ³¨</li>
                </ol>
            </div>
            <p><strong>æ–°åŠŸèƒ½ï¼š</strong></p>
            <ul>
                <li>âœ¨ æ”¯æŒæŒ‰å¥å­é€ä¸ªåˆ†æï¼Œç»“æœæ›´å‡†ç¡®</li>
                <li>ğŸ“Š å®æ—¶æ˜¾ç¤ºåˆ†æè¿›åº¦ï¼ˆç¬¬x/æ€»æ•°å¥ï¼‰</li>
                <li>â¹ï¸ æ”¯æŒä¸­é€”åœæ­¢åˆ†æ</li>
                <li>ğŸ’¡ æ”¹è¿›çš„AI Promptï¼Œè¯†åˆ«æ›´å‡†ç¡®</li>
                <li>ğŸ¯ æˆåŠŸ/å¤±è´¥ç»Ÿè®¡</li>
            </ul>
            <p><strong>é¢„æœŸç»“æœï¼š</strong>æ¯ä¸ªå¥å­æˆåˆ†éƒ½è¢«æ­£ç¡®è¯†åˆ«å’Œæ ‡æ³¨ï¼Œä¸»è¯­ã€è°“è¯­ã€å®¾è¯­ç­‰æ¸…æ™°å¯è§</p>
        </div>

        <header class="app-header" style="margin-top: 20px;">
            <div>
                <h1>æµ‹è¯•é˜…è¯»åŒº</h1>
            </div>
            <div class="header-actions">
                <button id="loadTestTextBtn" type="button">åŠ è½½æµ‹è¯•æ–‡æœ¬</button>
                <button id="themeToggleBtn" class="ghost-btn" type="button" title="åˆ‡æ¢ä¸»é¢˜">
                    <span class="theme-icon">ğŸŒ™</span>
                </button>
            </div>
        </header>

        <main class="layout" style="display: block; padding: 20px;">
            <section class="panel reader-panel">
                <header class="panel-header">
                    <h2>é˜…è¯»æ ‡æ³¨åŒº</h2>
                    <div class="reader-tools">
                        <button id="clearHighlightsBtn" class="ghost-btn" type="button">æ¸…é™¤å…¨éƒ¨æ ‡æ³¨</button>
                        <button id="aiAnalyzeBtn" type="button" class="ghost-btn">ğŸ¤– AIåˆ†æ</button>
                        <button id="showAISettingsBtn" class="ghost-btn" type="button">ğŸ¤– AIè®¾ç½®</button>
                    </div>
                </header>

                <div class="formatting-toolbar" role="toolbar" aria-label="å¿«é€Ÿæ ‡æ³¨å·¥å…·">
                    <div class="format-group" aria-label="æ–‡æœ¬æ ·å¼">
                        <button type="button" id="formatBoldToggle" class="format-btn" data-format="bold" title="åŠ ç²—">B</button>
                        <button type="button" id="formatUnderlineToggle" class="format-btn" data-format="underline" title="ä¸‹åˆ’çº¿">U</button>
                    </div>
                    <div class="format-group color-group" aria-label="èƒŒæ™¯é¢œè‰²">
                        <button type="button" class="format-color" data-color="honey" title="èœœç³–è‰²"></button>
                        <button type="button" class="format-color" data-color="mint" title="è–„è·è‰²"></button>
                        <button type="button" class="format-color" data-color="sky" title="å¤©ç©ºè‰²"></button>
                        <button type="button" class="format-color" data-color="orchid" title="å…°èŠ±è‰²"></button>
                        <button type="button" class="format-color" data-color="sunset" title="è½æ—¥è‰²"></button>
                    </div>
                    <button type="button" id="formatApplyBtn" class="ghost-btn format-apply">å¿«é€Ÿæ ‡æ³¨</button>
                </div>

                <div id="readingArea" class="reading-area" tabindex="0" style="min-height: 400px;">
                    <p class="placeholder">ç‚¹å‡»"åŠ è½½æµ‹è¯•æ–‡æœ¬"å¼€å§‹æµ‹è¯•æ‰€æœ‰ä¿®å¤åŠŸèƒ½...</p>
                </div>
            </section>
        </main>
    </div>

    <!-- æ ‡æ³¨å·¥å…·æ  -->
    <div id="selectionToolbar" class="selection-toolbar hidden" role="dialog">
        <form id="annotationForm">
            <fieldset>
                <legend>æ ‡æ³¨ç±»å‹</legend>
                <div class="category-buttons">
                    <button type="button" data-category="vocab">ç”Ÿè¯</button>
                    <button type="button" data-category="phrase">è¯ç»„</button>
                    <button type="button" data-category="difficulty">ç–‘éš¾</button>
                    <button type="button" data-category="keypoint">é‡ç‚¹</button>
                </div>
            </fieldset>
            <fieldset>
                <legend>æ ·å¼</legend>
                <div class="style-options">
                    <div class="color-palette">
                        <button type="button" data-color="honey"></button>
                        <button type="button" data-color="mint"></button>
                        <button type="button" data-color="sky"></button>
                        <button type="button" data-color="orchid"></button>
                        <button type="button" data-color="sunset"></button>
                    </div>
                    <div class="style-toggles">
                        <label class="style-toggle">
                            <input type="checkbox" id="boldToggle"> åŠ ç²—
                        </label>
                        <label class="style-toggle">
                            <input type="checkbox" id="underlineToggle"> ä¸‹åˆ’çº¿
                        </label>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend>å¤‡æ³¨</legend>
                <textarea id="noteInput" rows="2" placeholder="æ·»åŠ é‡Šä¹‰"></textarea>
                <input id="tagsInput" type="text" placeholder="æ ‡ç­¾">
            </fieldset>
            <div class="toolbar-actions">
                <button type="button" id="cancelAnnotationBtn" class="ghost-btn">å–æ¶ˆ</button>
                <button type="submit">ä¿å­˜</button>
            </div>
        </form>
    </div>

    <!-- AIè®¾ç½®æ¨¡æ€æ¡† -->
    <div id="aiSettingsModal" class="shortcuts-modal hidden">
        <div class="shortcuts-modal__overlay"></div>
        <div class="shortcuts-modal__content">
            <header class="shortcuts-modal__header">
                <h2>ğŸ¤– AIè¯­æ³•åˆ†æè®¾ç½®</h2>
                <button id="closeAISettingsBtn" class="shortcuts-modal__close">âœ•</button>
            </header>
            <div class="shortcuts-modal__body">
                <section class="shortcuts-section">
                    <h3>APIé…ç½®</h3>
                    <div style="margin-bottom: 16px;">
                        <label for="aiApiKey">API Key</label>
                        <input type="password" id="aiApiKey" placeholder="è¾“å…¥APIå¯†é’¥" style="width: 100%; padding: 8px; margin-top: 4px;">
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label for="aiApiEndpoint">APIç«¯ç‚¹</label>
                        <input type="text" id="aiApiEndpoint" placeholder="https://api.openai.com/v1/chat/completions" style="width: 100%; padding: 8px; margin-top: 4px;">
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label for="aiModel">æ¨¡å‹</label>
                        <select id="aiModel" style="width: 100%; padding: 8px; margin-top: 4px;">
                            <option value="gpt-4">GPT-4</option>
                            <option value="gpt-3.5-turbo" selected>GPT-3.5 Turbo</option>
                            <option value="custom">è‡ªå®šä¹‰</option>
                        </select>
                    </div>
                </section>
                <section class="shortcuts-section">
                    <h3>åˆ†æé€‰é¡¹</h3>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="aiAutoApply" checked>
                        è‡ªåŠ¨åº”ç”¨æ ‡æ³¨
                    </label>
                </section>
                <div style="text-align: right; margin-top: 20px;">
                    <button id="saveAISettingsBtn" type="button" style="padding: 10px 24px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">ä¿å­˜è®¾ç½®</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // æµ‹è¯•è¾…åŠ©è„šæœ¬
        document.addEventListener('DOMContentLoaded', function() {
            const loadBtn = document.getElementById('loadTestTextBtn');
            if (loadBtn) {
                loadBtn.addEventListener('click', function() {
                    const testText = `
                        <h3>English Learning Test Document</h3>
                        <p>The quick brown fox jumps over the lazy dog. This sentence contains every letter of the English alphabet and is perfect for testing.</p>
                        <p>In an era defined by relentless information flows, the ability to read analytically has become a critical survival skill. Effective readers question assumptions and synthesize insights.</p>
                        <p>Education is the most powerful weapon which you can use to change the world. Knowledge empowers individuals to make informed decisions.</p>
                        <p>Practice makes perfect. Consistent effort leads to mastery.</p>
                    `;

                    const readingArea = document.getElementById('readingArea');
                    if (readingArea) {
                        readingArea.innerHTML = testText;

                        // åˆ›å»ºæµ‹è¯•æ–‡æ¡£
                        if (typeof state !== 'undefined') {
                            const testDoc = {
                                id: 'test-doc-' + Date.now(),
                                title: 'Test Document - All Fixes',
                                content: testText,
                                annotations: [],
                                createdAt: new Date().toISOString(),
                                updatedAt: new Date().toISOString()
                            };
                            state.documents.push(testDoc);
                            state.activeDocumentId = testDoc.id;

                            if (typeof showToast === 'function') {
                                showToast('âœ“ æµ‹è¯•æ–‡æœ¬å·²åŠ è½½ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•ï¼', 'success');
                            }
                        }
                    }
                });
            }

            // è‡ªåŠ¨æ˜¾ç¤ºæ¬¢è¿æç¤º
            setTimeout(() => {
                if (typeof showToast === 'function') {
                    showToast('ğŸ‘‹ æ¬¢è¿ä½¿ç”¨æµ‹è¯•é¡µé¢ï¼ç‚¹å‡»"åŠ è½½æµ‹è¯•æ–‡æœ¬"å¼€å§‹', 'info');
                }
            }, 1000);
        });
    </script>
</body>
</html>
